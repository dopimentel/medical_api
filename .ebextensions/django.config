# Settings and commands for Amazon Linux 2023 Python Platform

packages:
  yum:
    # Nome correto para Amazon Linux 2023
    libpq-devel: []
    gcc: []

option_settings:
  aws:elasticbeanstalk:application:environment:
    # Garante que o Django use as configurações de produção corretas
    DJANGO_SETTINGS_MODULE: core.settings.production
  aws:elasticbeanstalk:container:python:
    WSGIPath: core.wsgi:application

container_commands:
  01_migrate:
    # Executa o migrate e salva qualquer erro em /var/log/migrate.log
    command: "source /var/app/venv/*/bin/activate && python manage.py migrate --noinput > /var/log/migrate.log 2>&1"
    leader_only: true